"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __exportStar = (this && this.__exportStar) || function(m, exports) {
    for (var p in m) if (p !== "default" && !exports.hasOwnProperty(p)) __createBinding(exports, m, p);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.Platform = exports.Metrics = exports.Keystore = exports.Info = exports.Health = exports.AVM = exports.Admin = exports.AvalancheCore = exports.CoreTypes = exports.DB = exports.BinTools = exports.Avalanche = void 0;
/**
 * @packageDocumentation
 * @module Avalanche
 */
const avalanche_1 = __importDefault(require("./avalanche"));
exports.AvalancheCore = avalanche_1.default;
const api_1 = __importDefault(require("./apis/admin/api"));
exports.Admin = api_1.default;
const api_2 = __importDefault(require("./apis/avm/api"));
exports.AVM = api_2.default;
const api_3 = __importDefault(require("./apis/health/api"));
exports.Health = api_3.default;
const api_4 = __importDefault(require("./apis/info/api"));
exports.Info = api_4.default;
const api_5 = __importDefault(require("./apis/keystore/api"));
exports.Keystore = api_5.default;
const api_6 = __importDefault(require("./apis/metrics/api"));
exports.Metrics = api_6.default;
const api_7 = __importDefault(require("./apis/platformvm/api"));
exports.Platform = api_7.default;
const CoreTypes = __importStar(require("./utils/types"));
exports.CoreTypes = CoreTypes;
const bintools_1 = __importDefault(require("./utils/bintools"));
exports.BinTools = bintools_1.default;
const db_1 = __importDefault(require("./utils/db"));
exports.DB = db_1.default;
const types_1 = require("./utils/types");
/**
 * Avalanche.js is middleware for interacting with Avalanche node RPC APIs.
 *
 * Example usage:
 * ```js
 * let avalanche = new Avalanche("127.0.0.1", 9650, "https");
 * ```
 *
 */
class Avalanche extends avalanche_1.default {
    /**
       * Creates a new Avalanche instance. Sets the address and port of the main Avalanche Client.
       *
       * @param ip The hostname to resolve to reach the Avalanche Client RPC APIs
       * @param port The port to resolve to reach the Avalanche Client RPC APIs
       * @param protocol The protocol string to use before a "://" in a request,
       * ex: "http", "https", "git", "ws", etc ...
       * @param networkid Sets the NetworkID of the class. Default 3
       * @param avmChainID Sets the blockchainID for the AVM. Will try to auto-detect,
       * otherwise default "2oALd6xoUMp3oSHMiJYVqMcbaWxGQWYosrfiT7AaFKKNG5dmKD"
       * @param skipinit Skips creating the APIs
       */
    constructor(ip, port, protocol = 'http', networkID = types_1.DefaultNetworkID, avmChainID = undefined, hrp = undefined, skipinit = false) {
        super(ip, port, protocol);
        /**
           * Returns a reference to the Admin RPC.
           */
        this.Admin = () => this.apis.admin;
        /**
           * Returns a reference to the AVM RPC pointed at the X-Chain.
           */
        this.XChain = () => this.apis.xchain;
        /**
           * Returns a reference to the Health RPC for a node.
           */
        this.Health = () => this.apis.health;
        /**
           * Returns a reference to the Info RPC for a node.
           */
        this.Info = () => this.apis.info;
        /**
           * Returns a reference to the Metrics RPC.
           */
        this.Metrics = () => this.apis.metrics;
        /**
           * Returns a reference to the Keystore RPC for a node. We label it "NodeKeys" to reduce
           * confusion about what it's accessing.
           */
        this.NodeKeys = () => this.apis.keystore;
        /**
           * Returns a reference to the PlatformVM RPC pointed at the P-Chain.
           */
        this.PChain = () => this.apis.pchain;
        let chainid = avmChainID;
        if (typeof avmChainID === 'undefined'
            || !avmChainID
            || avmChainID.toLowerCase() === 'avm'
            || avmChainID.toLowerCase() === 'x') {
            if (networkID.toString() in types_1.Defaults.network) {
                chainid = types_1.Defaults.network[networkID].X.blockchainID;
            }
            else {
                chainid = '2oALd6xoUMp3oSHMiJYVqMcbaWxGQWYosrfiT7AaFKKNG5dmKD';
            }
        }
        if (typeof networkID === 'number' && networkID >= 0) {
            this.networkID = networkID;
        }
        else if (typeof networkID === "undefined") {
            networkID = types_1.DefaultNetworkID;
        }
        if (typeof hrp !== "undefined") {
            this.hrp = hrp;
        }
        else {
            this.hrp = types_1.getPreferredHRP(this.networkID);
        }
        if (!skipinit) {
            this.addAPI('admin', api_1.default);
            this.addAPI('xchain', api_2.default, '/ext/bc/X', chainid);
            this.addAPI('health', api_3.default);
            this.addAPI('info', api_4.default);
            this.addAPI('keystore', api_5.default);
            this.addAPI('metrics', api_6.default);
            this.addAPI('pchain', api_7.default);
        }
    }
}
exports.default = Avalanche;
exports.Avalanche = Avalanche;
__exportStar(require("./avalanche"), exports);
__exportStar(require("./apis/avm/api"), exports);
__exportStar(require("./apis/admin/api"), exports);
__exportStar(require("./apis/keystore/api"), exports);
__exportStar(require("./apis/platformvm/api"), exports);
__exportStar(require("./utils/bintools"), exports);
__exportStar(require("./utils/db"), exports);
__exportStar(require("./utils/payload"), exports);
__exportStar(require("./utils/types"), exports);
var credentials_1 = require("./apis/avm/credentials");
Object.defineProperty(exports, "SelectCredentialClass", { enumerable: true, get: function () { return credentials_1.SelectCredentialClass; } });
Object.defineProperty(exports, "Credential", { enumerable: true, get: function () { return credentials_1.Credential; } });
Object.defineProperty(exports, "SecpCredential", { enumerable: true, get: function () { return credentials_1.SecpCredential; } });
Object.defineProperty(exports, "NFTCredential", { enumerable: true, get: function () { return credentials_1.NFTCredential; } });
var inputs_1 = require("./apis/avm/inputs");
Object.defineProperty(exports, "SelectInputClass", { enumerable: true, get: function () { return inputs_1.SelectInputClass; } });
Object.defineProperty(exports, "Input", { enumerable: true, get: function () { return inputs_1.Input; } });
Object.defineProperty(exports, "TransferableInput", { enumerable: true, get: function () { return inputs_1.TransferableInput; } });
Object.defineProperty(exports, "AmountInput", { enumerable: true, get: function () { return inputs_1.AmountInput; } });
Object.defineProperty(exports, "SecpInput", { enumerable: true, get: function () { return inputs_1.SecpInput; } });
var keychain_1 = require("./apis/avm/keychain");
Object.defineProperty(exports, "AVMKeyPair", { enumerable: true, get: function () { return keychain_1.AVMKeyPair; } });
Object.defineProperty(exports, "AVMKeyChain", { enumerable: true, get: function () { return keychain_1.AVMKeyChain; } });
var ops_1 = require("./apis/avm/ops");
Object.defineProperty(exports, "SelectOperationClass", { enumerable: true, get: function () { return ops_1.SelectOperationClass; } });
Object.defineProperty(exports, "Operation", { enumerable: true, get: function () { return ops_1.Operation; } });
Object.defineProperty(exports, "TransferableOperation", { enumerable: true, get: function () { return ops_1.TransferableOperation; } });
Object.defineProperty(exports, "NFTTransferOperation", { enumerable: true, get: function () { return ops_1.NFTTransferOperation; } });
Object.defineProperty(exports, "NFTMintOperation", { enumerable: true, get: function () { return ops_1.NFTMintOperation; } });
var outputs_1 = require("./apis/avm/outputs");
Object.defineProperty(exports, "SelectOutputClass", { enumerable: true, get: function () { return outputs_1.SelectOutputClass; } });
Object.defineProperty(exports, "Output", { enumerable: true, get: function () { return outputs_1.Output; } });
Object.defineProperty(exports, "TransferableOutput", { enumerable: true, get: function () { return outputs_1.TransferableOutput; } });
Object.defineProperty(exports, "AmountOutput", { enumerable: true, get: function () { return outputs_1.AmountOutput; } });
Object.defineProperty(exports, "SecpOutput", { enumerable: true, get: function () { return outputs_1.SecpOutput; } });
Object.defineProperty(exports, "NFTOutBase", { enumerable: true, get: function () { return outputs_1.NFTOutBase; } });
Object.defineProperty(exports, "NFTTransferOutput", { enumerable: true, get: function () { return outputs_1.NFTTransferOutput; } });
Object.defineProperty(exports, "NFTMintOutput", { enumerable: true, get: function () { return outputs_1.NFTMintOutput; } });
var tx_1 = require("./apis/avm/tx");
Object.defineProperty(exports, "BaseTx", { enumerable: true, get: function () { return tx_1.BaseTx; } });
Object.defineProperty(exports, "CreateAssetTx", { enumerable: true, get: function () { return tx_1.CreateAssetTx; } });
Object.defineProperty(exports, "OperationTx", { enumerable: true, get: function () { return tx_1.OperationTx; } });
Object.defineProperty(exports, "UnsignedTx", { enumerable: true, get: function () { return tx_1.UnsignedTx; } });
Object.defineProperty(exports, "Tx", { enumerable: true, get: function () { return tx_1.Tx; } });
var types_2 = require("./apis/avm/types");
Object.defineProperty(exports, "SigIdx", { enumerable: true, get: function () { return types_2.SigIdx; } });
Object.defineProperty(exports, "Signature", { enumerable: true, get: function () { return types_2.Signature; } });
Object.defineProperty(exports, "Address", { enumerable: true, get: function () { return types_2.Address; } });
Object.defineProperty(exports, "UTXOID", { enumerable: true, get: function () { return types_2.UTXOID; } });
Object.defineProperty(exports, "InitialStates", { enumerable: true, get: function () { return types_2.InitialStates; } });
Object.defineProperty(exports, "AVMConstants", { enumerable: true, get: function () { return types_2.AVMConstants; } });
Object.defineProperty(exports, "UnixNow", { enumerable: true, get: function () { return types_2.UnixNow; } });
var utxos_1 = require("./apis/avm/utxos");
Object.defineProperty(exports, "UTXO", { enumerable: true, get: function () { return utxos_1.UTXO; } });
Object.defineProperty(exports, "UTXOSet", { enumerable: true, get: function () { return utxos_1.UTXOSet; } });
var keychain_2 = require("./apis/platformvm/keychain");
Object.defineProperty(exports, "PlatformVMKeyPair", { enumerable: true, get: function () { return keychain_2.PlatformVMKeyPair; } });
Object.defineProperty(exports, "PlatformVMKeyChain", { enumerable: true, get: function () { return keychain_2.PlatformVMKeyChain; } });
var types_3 = require("./apis/platformvm/types");
Object.defineProperty(exports, "PlatformVMConstants", { enumerable: true, get: function () { return types_3.PlatformVMConstants; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7R0FHRztBQUNILDREQUF3QztBQXFIL0Isd0JBckhGLG1CQUFhLENBcUhFO0FBcEh0QiwyREFBd0M7QUE0SW5CLGdCQTVJZCxhQUFRLENBNElXO0FBM0kxQix5REFBb0M7QUE0SWpCLGNBNUlaLGFBQU0sQ0E0SVM7QUEzSXRCLDREQUEwQztBQTRJcEIsaUJBNUlmLGFBQVMsQ0E0SVk7QUEzSTVCLDBEQUFzQztBQTRJbEIsZUE1SWIsYUFBTyxDQTRJVTtBQTNJeEIsOERBQThDO0FBNEl0QixtQkE1SWpCLGFBQVcsQ0E0SWM7QUEzSWhDLDZEQUE0QztBQTRJckIsa0JBNUloQixhQUFVLENBNElhO0FBM0k5QixnRUFBa0Q7QUE0SXhCLG1CQTVJbkIsYUFBYSxDQTRJYztBQTNJbEMseURBQTJDO0FBNEdsQyw4QkFBUztBQTNHbEIsZ0VBQXdDO0FBeUcvQixtQkF6R0Ysa0JBQVEsQ0F5R0U7QUF4R2pCLG9EQUE0QjtBQXlHbkIsYUF6R0YsWUFBRSxDQXlHRTtBQXhHWCx5Q0FBNEU7QUFFNUU7Ozs7Ozs7O0dBUUc7QUFDSCxNQUFxQixTQUFVLFNBQVEsbUJBQWE7SUFxQ2xEOzs7Ozs7Ozs7OztTQVdLO0lBQ0wsWUFBWSxFQUFTLEVBQ25CLElBQVcsRUFDWCxXQUFrQixNQUFNLEVBQ3hCLFlBQW1CLHdCQUFnQixFQUNuQyxhQUFvQixTQUFTLEVBQzdCLE1BQWEsU0FBUyxFQUN0QixXQUFtQixLQUFLO1FBQ3hCLEtBQUssQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBdkQ1Qjs7YUFFSztRQUNMLFVBQUssR0FBRyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQWlCLENBQUM7UUFFMUM7O2FBRUs7UUFDTCxXQUFNLEdB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dGlvblxuICogQG1vZHVsZSBBdmFsYW5jaGVcbiAqL1xuaW1wb3J0IEF2YWxhbmNoZUNvcmUgZnJvbSAnLi9hdmFsYW5jaGUnO1xuaW1wb3J0IEFkbWluQVBJIGZyb20gJy4vYXBpcy9hZG1pbi9hcGknO1xuaW1wb3J0IEFWTUFQSSBmcm9tICcuL2FwaXMvYXZtL2FwaSc7XG5pbXBvcnQgSGVhbHRoQVBJIGZyb20gJy4vYXBpcy9oZWFsdGgvYXBpJztcbmltcG9ydCBJbmZvQVBJIGZyb20gJy4vYXBpcy9pbmZvL2FwaSc7XG5pbXBvcnQgS2V5c3RvcmVBUEkgZnJvbSAnLi9hcGlzL2tleXN0b3JlL2FwaSc7XG5pbXBvcnQgTWV0cmljc0FQSSBmcm9tICcuL2FwaXMvbWV0cmljcy9hcGknO1xuaW1wb3J0IFBsYXRmb3JtVk1BUEkgZnJvbSAnLi9hcGlzL3BsYXRmb3Jtdm0vYXBpJztcbmltcG9ydCAqIGFzIENvcmVUeXBlcyBmcm9tICcuL3V0aWxzL3R5cGVzJztcbmltcG9ydCBCaW5Ub29scyBmcm9tICcuL3V0aWxzL2JpbnRvb2xzJztcbmltcG9ydCBEQiBmcm9tICcuL3V0aWxzL2RiJztcbmltcG9ydCB7IERlZmF1bHRzLCBEZWZhdWx0TmV0d29ya0lELCBnZXRQcmVmZXJyZWRIUlAgfSBmcm9tICcuL3V0aWxzL3R5cGVzJztcblxuLyoqXG4gKiBBdmFsYW5jaGUuanMgaXMgbWlkZGxld2FyZSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCBBdmFsYW5jaGUgbm9kZSBSUEMgQVBJcy5cbiAqXG4gKiBFeGFtcGxlIHVzYWdlOlxuICogYGBganNcbiAqIGxldCBhdmFsYW5jaGUgPSBuZXcgQXZhbGFuY2hlKFwiMTI3LjAuMC4xXCIsIDk2NTAsIFwiaHR0cHNcIik7XG4gKiBgYGBcbiAqXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF2YWxhbmNoZSBleHRlbmRzIEF2YWxhbmNoZUNvcmUge1xuICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBBZG1pbiBSUEMuXG4gICAgICovXG4gIEFkbWluID0gKCkgPT4gdGhpcy5hcGlzLmFkbWluIGFzIEFkbWluQVBJO1xuXG4gIC8qKlxuICAgICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIEFWTSBSUEMgcG9pbnRlZCBhdCB0aGUgWC1DaGFpbi5cbiAgICAgKi9cbiAgWENoYWluID0gKCkgPT4gdGhpcy5hcGlzLnhjaGFpbiBhcyBBVk1BUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgSGVhbHRoIFJQQyBmb3IgYSBub2RlLlxuICAgICAqL1xuICBIZWFsdGggPSAoKSA9PiB0aGlzLmFwaXMuaGVhbHRoIGFzIEhlYWx0aEFQSTtcblxuICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBJbmZvIFJQQyBmb3IgYSBub2RlLlxuICAgICAqL1xuICBJbmZvID0gKCkgPT4gdGhpcy5hcGlzLmluZm8gYXMgSW5mb0FQSTtcblxuICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHRvIHRoZSBNZXRyaWNzIFJQQy5cbiAgICAgKi9cbiAgTWV0cmljcyA9ICgpID0+IHRoaXMuYXBpcy5tZXRyaWNzIGFzIE1ldHJpY3NBUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgS2V5c3RvcmUgUlBDIGZvciBhIG5vZGUuIFdlIGxhYmVsIGl0IFwiTm9kZUtleXNcIiB0byByZWR1Y2VcbiAgICAgKiBjb25mdXNpb24gYWJvdXQgd2hhdCBpdCdzIGFjY2Vzc2luZy5cbiAgICAgKi9cbiAgTm9kZUtleXMgPSAoKSA9PiB0aGlzLmFwaXMua2V5c3RvcmUgYXMgS2V5c3RvcmVBUEk7XG5cbiAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgUGxhdGZvcm1WTSBSUEMgcG9pbnRlZCBhdCB0aGUgUC1DaGFpbi5cbiAgICAgKi9cbiAgUENoYWluID0gKCkgPT4gdGhpcy5hcGlzLnBjaGFpbiBhcyBQbGF0Zm9ybVZNQVBJO1xuXG4gIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgQXZhbGFuY2hlIGluc3RhbmNlLiBTZXRzIHRoZSBhZGRyZXNzIGFuZCBwb3J0IG9mIHRoZSBtYWluIEF2YWxhbmNoZSBDbGllbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXAgVGhlIGhvc3RuYW1lIHRvIHJlc29sdmUgdG8gcmVhY2ggdGhlIEF2YWxhbmNoZSBDbGllbnQgUlBDIEFQSXNcbiAgICAgKiBAcGFyYW0gcG9ydCBUaGUgcG9ydCB0byByZXNvbHZlIHRvIHJlYWNoIHRoZSBBdmFsYW5jaGUgQ2xpZW50IFJQQyBBUElzXG4gICAgICogQHBhcmFtIHByb3RvY29sIFRoZSBwcm90b2NvbCBzdHJpbmcgdG8gdXNlIGJlZm9yZSBhIFwiOi8vXCIgaW4gYSByZXF1ZXN0LFxuICAgICAqIGV4OiBcImh0dHBcIiwgXCJodHRwc1wiLCBcImdpdFwiLCBcIndzXCIsIGV0YyAuLi5cbiAgICAgKiBAcGFyYW0gbmV0d29ya2lkIFNldHMgdGhlIE5ldHdvcmtJRCBvZiB0aGUgY2xhc3MuIERlZmF1bHQgM1xuICAgICAqIEBwYXJhbSBhdm1DaGFpbklEIFNldHMgdGhlIGJsb2NrY2hhaW5JRCBmb3IgdGhlIEFWTS4gV2lsbCB0cnkgdG8gYXV0by1kZXRlY3QsXG4gICAgICogb3RoZXJ3aXNlIGRlZmF1bHQgXCIyb0FMZDZ4b1VNcDNvU0hNaUpZVnFNY2JhV3hHUVdZb3NyZmlUN0FhRktLTkc1ZG1LRFwiXG4gICAgICogQHBhcmFtIHNraXBpbml0IFNraXBzIGNyZWF0aW5nIHRoZSBBUElzXG4gICAgICovXG4gIGNvbnN0cnVjdG9yKGlwOnN0cmluZyxcbiAgICBwb3J0Om51bWJlcixcbiAgICBwcm90b2NvbDpzdHJpbmcgPSAnaHR0cCcsXG4gICAgbmV0d29ya0lEOm51bWJlciA9IERlZmF1bHROZXR3b3JrSUQsXG4gICAgYXZtQ2hhaW5JRDpzdHJpbmcgPSB1bmRlZmluZWQsXG4gICAgaHJwOnN0cmluZyA9IHVuZGVmaW5lZCxcbiAgICBza2lwaW5pdDpib29sZWFuID0gZmFsc2UpIHtcbiAgICBzdXBlcihpcCwgcG9ydCwgcHJvdG9jb2wpO1xuICAgIGxldCBjaGFpbmlkID0gYXZtQ2hhaW5JRDtcbiAgICBpZiAodHlwZW9mIGF2bUNoYWluSUQgPT09ICd1bmRlZmluZWQnXG4gICAgfHwgIWF2bUNoYWluSURcbiAgICB8fCBhdm1DaGFpbklELnRvTG93ZXJDYXNlKCkgPT09ICdhdm0nXG4gICAgfHwgYXZtQ2hhaW5JRC50b0xvd2VyQ2FzZSgpID09PSAneCcpIHtcbiAgICAgIGlmIChuZXR3b3JrSUQudG9TdHJpbmcoKSBpbiBEZWZhdWx0cy5uZXR3b3JrKSB7XG4gICAgICAgIGNoYWluaWQgPSBEZWZhdWx0cy5uZXR3b3JrW25ldHdvcmtJRF0uWC5ibG9ja2NoYWluSUQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGFpbmlkID0gJzJvQUxkNnhvVU1wM29TSE1pSllWcU1jYmFXeEdRV1lvc3JmaVQ3QWFGS0tORzVkbUtEJztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR5cGVvZiBuZXR3b3JrSUQgPT09ICdudW1iZXInICYmIG5ldHdvcmtJRCA+PSAwKSB7XG4gICAgICB0aGlzLm5ldHdvcmtJRCA9IG5ldHdvcmtJRDtcbiAgICB9IGVsc2UgaWYodHlwZW9mIG5ldHdvcmtJRCA9PT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICBuZXR3b3JrSUQgPSBEZWZhdWx0TmV0d29ya0lEO1xuICAgIH1cbiAgICBpZih0eXBlb2YgaHJwICE9PSBcInVuZGVmaW5lZFwiKXtcbiAgICAgIHRoaXMuaHJwID0gaHJwO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhycCA9IGdldFByZWZlcnJlZEhSUCh0aGlzLm5ldHdvcmtJRCk7XG4gICAgfVxuICAgIFxuICAgIGlmICghc2tpcGluaXQpIHtcbiAgICAgIHRoaXMuYWRkQVBJKCdhZG1pbicsIEFkbWluQVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCd4Y2hhaW4nLCBBVk1BUEksICcvZXh0L2JjL1gnLCBjaGFpbmlkKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdoZWFsdGgnLCBIZWFsdGhBUEkpO1xuICAgICAgdGhpcy5hZGRBUEkoJ2luZm8nLCBJbmZvQVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdrZXlzdG9yZScsIEtleXN0b3JlQVBJKTtcbiAgICAgIHRoaXMuYWRkQVBJKCdtZXRyaWNzJywgTWV0cmljc0FQSSk7XG4gICAgICB0aGlzLmFkZEFQSSgncGNoYWluJywgUGxhdGZvcm1WTUFQSSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCB7IEF2YWxhbmNoZSB9O1xuZXhwb3J0IHsgQmluVG9vbHMgfTtcbmV4cG9ydCB7IERCIH07XG5leHBvcnQgeyBDb3JlVHlwZXMgfTtcbmV4cG9ydCB7IEF2YWxhbmNoZUNvcmUgfTtcblxuZXhwb3J0ICogZnJvbSAnLi9hdmFsYW5jaGUnO1xuZXhwb3J0ICogZnJvbSAnLi9hcGlzL2F2bS9hcGknO1xuZXhwb3J0ICogZnJvbSAnLi9hcGlzL2FkbWluL2FwaSc7XG5leHBvcnQgKiBmcm9tICcuL2FwaXMva2V5c3RvcmUvYXBpJztcbmV4cG9ydCAqIGZyb20gJy4vYXBpcy9wbGF0Zm9ybXZtL2FwaSc7XG5leHBvcnQgKiBmcm9tICcuL3V0aWxzL2JpbnRvb2xzJztcbmV4cG9ydCAqIGZyb20gJy4vdXRpbHMvZGInO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscy9wYXlsb2FkJztcbmV4cG9ydCAqIGZyb20gJy4vdXRpbHMvdHlwZXMnO1xuXG5leHBvcnQge1NlbGVjdENyZWRlbnRpYWxDbGFzcywgQ3JlZGVudGlhbCwgU2VjcENyZWRlbnRpYWwsIE5GVENyZWRlbnRpYWx9IGZyb20gJy4vYXBpcy9hdm0vY3JlZGVudGlhbHMnO1xuZXhwb3J0IHtTZWxlY3RJbnB1dENsYXNzLCBJbnB1dCwgVHJhbnNmZXJhYmxlSW5wdXQsIEFtb3VudElucHV0LCBTZWNwSW5wdXR9IGZyb20gJy4vYXBpcy9hdm0vaW5wdXRzJztcbmV4cG9ydCB7QVZNS2V5UGFpciwgQVZNS2V5Q2hhaW59IGZyb20gJy4vYXBpcy9hdm0va2V5Y2hhaW4nO1xuZXhwb3J0IHtTZWxlY3RPcGVyYXRpb25DbGFzcyxPcGVyYXRpb24sIFRyYW5zZmVyYWJsZU9wZXJhdGlvbiwgTkZUVHJhbnNmZXJPcGVyYXRpb24sIE5GVE1pbnRPcGVyYXRpb259IGZyb20gICcuL2FwaXMvYXZtL29wcyc7XG5leHBvcnQge1NlbGVjdE91dHB1dENsYXNzLCBPdXRwdXQsIFRyYW5zZmVyYWJsZU91dHB1dCwgQW1vdW50T3V0cHV0LCBTZWNwT3V0cHV0LCBORlRPdXRCYXNlLCBORlRUcmFuc2Zlck91dHB1dCwgTkZUTWludE91dHB1dH0gZnJvbSAnLi9hcGlzL2F2bS9vdXRwdXRzJztcbmV4cG9ydCB7QmFzZVR4LCBDcmVhdGVBc3NldFR4LCBPcGVyYXRpb25UeCwgVW5zaWduZWRUeCwgVHh9IGZyb20gJy4vYXBpcy9hdm0vdHgnO1xuZXhwb3J0IHtTaWdJZHgsIFNpZ25hdHVyZSwgQWRkcmVzcywgVVRYT0lELCBJbml0aWFsU3RhdGVzLCBBVk1Db25zdGFudHMsIE1lcmdlUnVsZSwgVW5peE5vd30gZnJvbSAnLi9hcGlzL2F2bS90eXBlcyc7XG5leHBvcnQge1VUWE8sIFVUWE9TZXR9IGZyb20gJy4vYXBpcy9hdm0vdXR4b3MnO1x0XG5cbmV4cG9ydCB7IFBsYXRmb3JtVk1LZXlQYWlyLCBQbGF0Zm9ybVZNS2V5Q2hhaW4gfSBmcm9tICcuL2FwaXMvcGxhdGZvcm12bS9rZXljaGFpbic7XG5leHBvcnQgeyBQbGF0Zm9ybVZNQ29uc3RhbnRzIH0gZnJvbSAnLi9hcGlzL3BsYXRmb3Jtdm0vdHlwZXMnO1xuXG5leHBvcnQgeyBBZG1pbkFQSSBhcyBBZG1pbiB9O1xuZXhwb3J0IHsgQVZNQVBJIGFzIEFWTSB9O1xuZXhwb3J0IHsgSGVhbHRoQVBJIGFzIEhlYWx0aCB9O1xuZXhwb3J0IHsgSW5mb0FQSSBhcyBJbmZvIH07XG5leHBvcnQgeyBLZXlzdG9yZUFQSSBhcyBLZXlzdG9yZSB9O1xuZXhwb3J0IHsgTWV0cmljc0FQSSBhcyBNZXRyaWNzIH07XG5leHBvcnQgeyBQbGF0Zm9ybVZNQVBJIGFzIFBsYXRmb3JtIH07Il19